<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Architecture d'Authentification OpenShift AI 2.22</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            font-size: 2.5em;
            margin-bottom: 30px;
            background: linear-gradient(45deg, #3498db, #e74c3c);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .architecture-diagram {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            position: relative;
            overflow: hidden;
        }
        .component {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            padding: 15px;
            margin: 10px;
            border-radius: 10px;
            text-align: center;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(116, 185, 255, 0.3);
            transition: all 0.3s ease;
            position: relative;
        }
        .component:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(116, 185, 255, 0.4);
        }
        .auth-component {
            background: linear-gradient(135deg, #fd79a8, #e84393);
            box-shadow: 0 4px 15px rgba(253, 121, 168, 0.3);
        }
        .model-component {
            background: linear-gradient(135deg, #00b894, #00a085);
            box-shadow: 0 4px 15px rgba(0, 184, 148, 0.3);
        }
        .security-component {
            background: linear-gradient(135deg, #fdcb6e, #e17055);
            box-shadow: 0 4px 15px rgba(253, 203, 110, 0.3);
        }
        .flow-arrow {
            font-size: 2em;
            color: #6c5ce7;
            text-align: center;
            margin: 10px 0;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }
        .info-box {
            background: linear-gradient(135deg, #a29bfe, #6c5ce7);
            color: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            border-left: 5px solid #fd79a8;
        }
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
        }
        .code-block pre {
            margin: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        .code-block code {
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.4;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .layer {
            margin: 20px 0;
            padding: 15px;
            border-left: 4px solid #3498db;
            background: linear-gradient(90deg, rgba(52, 152, 219, 0.1), transparent);
        }
        .highlight {
            background: linear-gradient(120deg, #a8edea 0%, #fed6e3 100%);
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
            color: #2c3e50;
        }
        .docs-links {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin: 30px 0;
        }
        .docs-links h3 {
            color: #2c3e50;
            margin-top: 0;
        }
        .docs-links a {
            color: #3498db;
            text-decoration: none;
            display: block;
            margin: 8px 0;
            padding: 5px 0;
            border-bottom: 1px solid #ecf0f1;
        }
        .docs-links a:hover {
            color: #2980b9;
            background: #ecf0f1;
            padding-left: 10px;
            transition: all 0.3s ease;
        }
        .back-link {
            background: #3498db;
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            text-decoration: none;
            display: inline-block;
            margin-bottom: 20px;
        }
        .back-link:hover {
            background: #2980b9;
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="../../" class="back-link">‚Üê Retour √† l'accueil</a>
        
        <h1>üîê Architecture d'Authentification OpenShift AI 2.22</h1>
        
        <div class="info-box">
            <h2>üéØ Vue d'ensemble - OpenShift AI 2.22 / OpenShift 4.19</h2>
            <p>OpenShift AI 2.22 utilise une architecture multicouche pour l'authentification des services d'inf√©rence, s'appuyant sur le serveur OAuth int√©gr√© d'OpenShift 4.19, les Service Accounts Kubernetes, et des composants sp√©cialis√©s comme Authorino pour la s√©curisation des mod√®les ML via KServe.</p>
        </div>

        <div class="docs-links">
            <h3>üìö Documentation officielle Red Hat utilis√©e</h3>
            <a href="https://docs.openshift.com/container-platform/4.19/openshift_images/using-images/using-s2i-builds/using-s2i-builds.html" target="_blank">Serving Models OpenShift AI</a>
            <a href="https://docs.openshift.com/container-platform/4.19/authentication/understanding-authentication.html" target="_blank">Understanding Authentication OpenShift 4.19</a>
            <a href="https://docs.openshift.com/container-platform/4.19/authentication/managing-oauth-access-tokens.html" target="_blank">Managing OAuth Access Tokens</a>
            <a href="https://docs.openshift.com/container-platform/4.19/authentication/identity_providers/configuring-ldap-identity-provider.html" target="_blank">Adding Authorization Provider</a>
            <a href="./README.md" target="_blank">üìñ Documentation d√©taill√©e Markdown</a>
        </div>

        <div class="architecture-diagram">
            <h3 style="text-align: center; color: #2c3e50;">üèóÔ∏è Architecture des composants d'authentification</h3>
            
            <div class="layer">
                <h4>üåê Couche Utilisateur & Interface</h4>
                <div class="grid">
                    <div class="component">
                        <strong>OpenShift AI Dashboard</strong><br>
                        Interface web pour la gestion des projets, mod√®les et authentification
                    </div>
                    <div class="component">
                        <strong>CLI oc</strong><br>
                        Interface en ligne de commande pour l'authentification et la gestion<br>
                        <code>oc whoami -t</code>
                    </div>
                </div>
            </div>

            <div class="flow-arrow">‚¨áÔ∏è</div>

            <div class="layer">
                <h4>üîê Couche d'authentification OAuth (OpenShift 4.19)</h4>
                <div class="grid">
                    <div class="auth-component component">
                        <strong>OAuth Server (OpenShift)</strong><br>
                        Serveur OAuth int√©gr√© - g√©n√®re et valide les tokens JWT<br>
                        Dur√©e par d√©faut: 24 heures
                    </div>
                    <div class="auth-component component">
                        <strong>Identity Providers</strong><br>
                        LDAP, SSO, OIDC - sources d'identit√© configurables<br>
                        Fournisseurs externes
                    </div>
                    <div class="auth-component component">
                        <strong>OAuth Clients</strong><br>
                        openshift-challenging-client<br>
                        openshift-browser-client<br>
                        console
                    </div>
                </div>
            </div>

            <div class="flow-arrow">‚¨áÔ∏è</div>

            <div class="layer">
                <h4>üõ°Ô∏è Couche Autorisation & S√©curit√©</h4>
                <div class="grid">
                    <div class="security-component component">
                        <strong>Authorino (Optionnel)</strong><br>
                        Fournisseur d'autorisation pour l'authentification des mod√®les KServe<br>
                        Validation des tokens
                    </div>
                    <div class="security-component component">
                        <strong>RBAC (Kubernetes)</strong><br>
                        Contr√¥le d'acc√®s bas√© sur les r√¥les<br>
                        Permissions granulaires
                    </div>
                    <div class="security-component component">
                        <strong>Service Accounts</strong><br>
                        Comptes de service avec tokens automatiques<br>
                        Isolation par namespace
                    </div>
                    <div class="security-component component">
                        <strong>OAuth Proxy üÜï</strong><br>
                        Model Registry (Nouveau 2.22)<br>
                        Remplace Authorino pour le registre
                    </div>
                </div>
            </div>

            <div class="flow-arrow">‚¨áÔ∏è</div>

            <div class="layer">
                <h4>üöÄ Couche Service Mesh & Routage</h4>
                <div class="grid">
                    <div class="component">
                        <strong>OpenShift Service Mesh (Istio)</strong><br>
                        Gestion du trafic, s√©curit√©, et observabilit√©<br>
                        mTLS automatique
                    </div>
                    <div class="component">
                        <strong>Knative Serving</strong><br>
                        Plateforme serverless pour le d√©ploiement des mod√®les<br>
                        Autoscaling intelligent
                    </div>
                </div>
            </div>

            <div class="flow-arrow">‚¨áÔ∏è</div>

            <div class="layer">
                <h4>ü§ñ Couche Serving des Mod√®les</h4>
                <div class="grid">
                    <div class="model-component component">
                        <strong>KServe (Single-Model)</strong><br>
                        Serving de mod√®les individuels avec autoscaling<br>
                        Support LLMs et GPU
                    </div>
                    <div class="model-component component">
                        <strong>ModelMesh (Multi-Model)</strong><br>
                        Serving optimis√© pour plusieurs mod√®les<br>
                        Ressources partag√©es
                    </div>
                </div>
            </div>
        </div>

        <div class="info-box">
            <h3>üîë Flux d'authentification Token</h3>
            <ol>
                <li><span class="highlight">Connexion utilisateur</span> ‚Üí OAuth Server OpenShift</li>
                <li><span class="highlight">G√©n√©ration token JWT</span> ‚Üí Associ√© au Service Account</li>
                <li><span class="highlight">D√©ploiement mod√®le</span> ‚Üí Token automatique via KServe</li>
                <li><span class="highlight">Requ√™te d'inf√©rence</span> ‚Üí Validation via Authorino + Service Mesh</li>
                <li><span class="highlight">Acc√®s autoris√©</span> ‚Üí Traitement par le runtime du mod√®le</li>
            </ol>
        </div>

        <div class="info-box">
            <h3>üìã R√¥les des composants principaux</h3>
            <div class="grid">
                <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
                    <h4>üéõÔ∏è Dashboard</h4>
                    <ul>
                        <li>Interface de gestion des projets</li>
                        <li>D√©ploiement de mod√®les</li>
                        <li>Visualisation des tokens</li>
                        <li>Configuration des permissions</li>
                    </ul>
                </div>
                <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
                    <h4>üîê OAuth Server</h4>
                    <ul>
                        <li>G√©n√©ration tokens JWT</li>
                        <li>Validation des identit√©s</li>
                        <li>Gestion des sessions</li>
                        <li>Int√©gration identity providers</li>
                    </ul>
                </div>
                <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
                    <h4>üîê Authorino</h4>
                    <ul>
                        <li>Validation des tokens pour KServe</li>
                        <li>Politiques d'autorisation</li>
                        <li>Int√©gration Service Mesh</li>
                        <li>Protection des endpoints</li>
                    </ul>
                </div>
                <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
                    <h4>üöÄ KServe</h4>
                    <ul>
                        <li>Orchestration des mod√®les</li>
                        <li>Autoscaling serverless</li>
                        <li>Gestion des runtimes</li>
                        <li>Endpoints d'inf√©rence</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="code-block">
            <pre><code># Exemples de commandes d'authentification

# R√©cup√©ration du token utilisateur
oc whoami -t

# Connexion avec token
oc login --token=sha256~...

# Requ√™te d'inf√©rence authentifi√©e
curl -X POST https://model-endpoint.apps.cluster.com/v1/models/mon-modele:predict \
  -H "Authorization: Bearer $(oc whoami -t)" \
  -H "Content-Type: application/json" \
  -d '{"instances": [{"data": "exemple"}]}'

# R√©cup√©ration du token depuis secret de mod√®le
oc get secret &lt;token-secret&gt; -o jsonpath='{.data.token}' | base64 -d

# Configuration OAuth avec dur√©e personnalis√©e
apiVersion: config.openshift.io/v1
kind: OAuth
metadata:
  name: cluster
spec:
  tokenConfig:
    accessTokenMaxAgeSeconds: 172800  # 48 heures</code></pre>
        </div>

        <div class="info-box">
            <h3>‚ö° Configuration des tokens OAuth</h3>
            <ul>
                <li><strong>Dur√©e par d√©faut</strong> : 24 heures (86400 secondes)</li>
                <li><strong>Timeout d'inactivit√©</strong> : Configurable (ex: 400s)</li>
                <li><strong>Scopes disponibles</strong> : user:full, user:info, user:check-access</li>
                <li><strong>Clients automatiques</strong> : openshift-challenging-client, console, browser-client</li>
            </ul>
        </div>

        <div class="info-box">
            <h3>üÜï Nouveaut√©s authentification OpenShift AI 2.22</h3>
            <ul>
                <li><strong>OAuth Proxy pour Model Registry</strong> : Plus besoin d'Authorino/Serverless/Service Mesh</li>
                <li><strong>Migration automatique</strong> : Instances existantes migr√©es vers OAuth proxy</li>
                <li><strong>Simplification</strong> : Configuration r√©duite pour cas d'usage courants</li>
                <li><strong>Backward compatibility</strong> : Support maintenu pour configurations existantes</li>
            </ul>
        </div>

        <div class="info-box">
            <h3>üîí S√©curit√© et bonnes pratiques</h3>
            <ul>
                <li><strong>Rotation automatique</strong> des tokens avec dur√©e de vie configurable</li>
                <li><strong>Isolation par namespace</strong> - chaque mod√®le dans son environnement s√©curis√©</li>
                <li><strong>RBAC granulaire</strong> - permissions sp√©cifiques par r√¥le (data-scientist, model-consumer, etc.)</li>
                <li><strong>Chiffrement TLS</strong> - toutes les communications s√©curis√©es via Service Mesh</li>
                <li><strong>mTLS automatique</strong> - authentification mutuelle entre services</li>
                <li><strong>Monitoring des acc√®s</strong> - logs et m√©triques Prometheus int√©gr√©s</li>
            </ul>
        </div>

        <div style="background: #e8f4f8; border-radius: 10px; padding: 20px; margin: 30px 0; border-left: 5px solid #3498db;">
            <h3 style="color: #2c3e50; margin-top: 0;">üõ†Ô∏è Guide de d√©pannage authentification</h3>
            <div class="code-block">
                <pre><code># V√©rifier la validit√© d'un token
oc auth can-i get pods --token=&lt;your-token&gt;

# Tester l'endpoint d'inf√©rence
curl -I -H "Authorization: Bearer &lt;token&gt;" &lt;inference-endpoint&gt;

# Lister les tokens OAuth utilisateur
oc get useroauthaccesstokens

# V√©rifier les logs Service Mesh
oc logs -n istio-system deployment/istiod | grep -i auth

# Supprimer un token expir√©
oc delete useroauthaccesstoken &lt;token-name&gt;</code></pre>
            </div>
        </div>
    </div>
</body>
</html>
